@model Modelo.Proxy.pxyCwGrupoAcesso
@{
    ViewBag.Title = "Permissões de Acesso por Grupo";
}
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(model => model.NomeGrupo)
    <div class="">
        <div class="panel panel-default" style="padding:0; margin-bottom:0px;">
            <div class="panel-heading salvando">
                @Html.ActionLink("X", "Grid", "GrupoAcesso", null, new { @class = "close" })
                <h3 class="panel-title titulo-pagina">@ViewBag.Title</h3>
            </div>
            <div class="panel-body panelConteudo" id="">
                @Html.ValidationMessage("CustomError")
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            @Html.LabelFor(model => model.NomeGrupo, new { @class = "control-label label-sm" })
                            @Html.TextBoxFor(model => model.NomeGrupo, new { @class = "form-control input-sm disabled", @id = "txtGrupo" })
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default">
                            <div class="panel-heading clearfix" style="padding-bottom:5px; padding-top:5px;">
                                <label class="panel-title label-sm pull-left" style="padding-top:3px;">Permissões</label>
                                <div class="col-md-5 pull-right" style="padding:0px;">
                                    <div class="col-md-3" style="padding:0px;">
                                        <div class="btn-group btn-group-sm">
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btSelecionarConsultas" class="btn input-sm btn-primary"><span id="spAllConsulta" class="glyphicon glyphicon-ok"></span></button>
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btDesselecionarConsultas" class="btn input-sm btn-primary"><span id="spNoneConsulta" class="glyphicon glyphicon-remove"></span></button>
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btInverterConsultas" class="btn input-sm btn-primary"><span id="spRevConsulta" class="glyphicon glyphicon-refresh"></span></button>
                                        </div>
                                    </div>
                                    <div class="col-md-3" style="padding:0px;">
                                        <div class="btn-group btn-group-sm">
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btSelecionarInserts" class="btn input-sm btn-primary"><span id="spAllConsulta" class="glyphicon glyphicon-ok"></span></button>
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btDesselecionarInserts" class="btn input-sm btn-primary"><span id="spNoneConsulta" class="glyphicon glyphicon-remove"></span></button>
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btInverterInserts" class="btn input-sm btn-primary"><span id="spRevConsulta" class="glyphicon glyphicon-refresh"></span></button>
                                        </div>
                                    </div>
                                    <div class="col-md-3" style="padding:0px;">
                                        <div class="btn-group btn-group-sm">
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btSelecionarAlters" class="btn input-sm btn-primary"><span id="spAllConsulta" class="glyphicon glyphicon-ok"></span></button>
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btDesselecionarAlters" class="btn input-sm btn-primary"><span id="spNoneConsulta" class="glyphicon glyphicon-remove"></span></button>
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btInverterAlters" class="btn input-sm btn-primary"><span id="spRevConsulta" class="glyphicon glyphicon-refresh"></span></button>
                                        </div>
                                    </div>
                                    <div class="col-md-3" style="padding:0px;">
                                        <div class="btn-group btn-group-sm">
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btSelecionarRemoves" class="btn input-sm btn-primary"><span id="spAllConsulta" class="glyphicon glyphicon-ok"></span></button>
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btDesselecionarRemoves" class="btn input-sm btn-primary"><span id="spNoneConsulta" class="glyphicon glyphicon-remove"></span></button>
                                            <button type="button" style="padding-left:6px; padding-right:6px;" id="btInverterRemoves" class="btn input-sm btn-primary"><span id="spRevConsulta" class="glyphicon glyphicon-refresh"></span></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4 pull-right" style="padding-top:0px; padding-bottom:0px;">
                                    <label class="panel-title control-label label-sm" style="padding-top:3px;">Buscar:</label>
                                    <div class="col-md-9 pull-right" style="padding:0px;">
                                        <input type="text" id="txtFiltro" class="form-control input-sm" />
                                    </div>
                                </div>
                            </div>
                            <div class="panel-body" style="padding:0px;">
                                <div class="div_table_highlight" style="height:292px;">
                                    <table id="tbPerms" class="table table-striped table-bordered table-hover table-condensed nowrap" cellspacing="0" width="100%">
                                        <thead>
                                            <tr>
                                                <th>Menu</th>
                                                <th>Página</th>
                                                <th>Consultar</th>
                                                <th>Inserir</th>
                                                <th>Alterar</th>
                                                <th>Excluir</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @Html.EditorFor(model => model.Permissoes)
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel-footer">
                <div class="row">
                    <div class="col-xs-12 center-block">
                        <div style="text-align: right">
                            <button type="submit" class="btn btn-success salvando">
                                <span class="glyphicon glyphicon-ok-circle"></span> &nbsp;Salvar&nbsp;&nbsp;
                            </button>
                            <a class="btn btn-danger"
                               href="@Url.Action("Grid", "GrupoAcesso")">
                                <span class="glyphicon glyphicon-remove salvando"></span> Cancelar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
<script>
    $('#txtGrupo').attr('disabled', 'disabled');
    $(":input[type='text']:enabled:visible:first").focus();

    var oTbPerms = cwk_MicroTBRelatorios('#tbPerms', retornaAltura(), true);

    function retornaAltura() {
        var altura = cwk_AlturaTela() * 48 / 100;
        if (cwk_AlturaTela() <= 768) {
            altura = cwk_AlturaTela() * 38 / 100;
        }
        return altura;
    }

    $.expr[":"].contains = $.expr.createPseudo(function (arg) {
        return function (elem) {
            return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
        };
    });

    $('#btSelecionarConsultas').click(function () {
        selecionarTodos('.chkConsultar');
    });
    $('#btDesselecionarConsultas').click(function () {
        removerSelecaoTodos('.chkConsultar')
    });
    $('#btInverterConsultas').click(function () {
        inverterSelecao('.chkConsultar');
    });

    $('#btSelecionarInserts').click(function () {
        selecionarTodos('.chkCadastrar');
    });
    $('#btDesselecionarInserts').click(function () {
        removerSelecaoTodos('.chkCadastrar')
    });
    $('#btInverterInserts').click(function () {
        inverterSelecao('.chkCadastrar');
    });

    $('#btSelecionarAlters').click(function () {
        selecionarTodos('.chkAlterar');
    });
    $('#btDesselecionarAlters').click(function () {
        removerSelecaoTodos('.chkAlterar')
    });
    $('#btInverterAlters').click(function () {
        inverterSelecao('.chkAlterar');
    });

    $('#btSelecionarRemoves').click(function () {
        selecionarTodos('.chkExcluir');
    });
    $('#btDesselecionarRemoves').click(function () {
        removerSelecaoTodos('.chkExcluir')
    });
    $('#btInverterRemoves').click(function () {
        inverterSelecao('.chkExcluir');
    });

    function selecionarTodos(classeCheck) {
        $(classeCheck).prop('checked', true);
    }

    function removerSelecaoTodos(classeCheck) {
        $(classeCheck).prop('checked', false);
    }

    function inverterSelecao(classeCheck) {
        var checked = $(classeCheck).filter(function () { return this.checked; });
        var notchecked = $(classeCheck).filter(function () { return !this.checked; });
        checked.prop('checked', false);
        notchecked.prop('checked', true);

    }

    $('#txtFiltro').keyup(function () {
        filtraGrid($('#txtFiltro').val());
    });

    function filtraGrid(texto) {
        filtraTabelaPorTexto([texto], '#tbPerms');
    }

    $("form").submit(function () {
        $("#txtFiltro").val("");
        filtraGrid("");
    });
</script>
@if (ViewBag.Consultar == 1)
{
    <script>
        $(document).ready(function () {
            $('form').find('input, textarea, button, select').attr('disabled', 'disabled');
        })
    </script>
}