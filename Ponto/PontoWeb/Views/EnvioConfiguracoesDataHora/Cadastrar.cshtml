@model Modelo.EnvioConfiguracoesDataHora
@using System.Web.Optimization

@{
    ViewBag.Title = "REP - Configurar Data e Hora";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using (Html.BeginForm())
{
    <div class="divCenterPequeno">
        <div class="panel panel-default" style="padding:0px;">
            <div class="panel-heading">
                @Html.ActionLink("X", "Index", "Home", null, new { @class = "close" })
                <h3 class="panel-title titulo-pagina">@ViewBag.Title</h3>
            </div>
            <div class="panel-body panelConteudo">
                @Html.ValidationSummary(true)
                @Html.HiddenFor(model => model.idRelogio)
                @Html.HiddenFor(model => model.bEnviaHorarioVerao)
                @Html.HiddenFor(model => model.bEnviaDataHoraServidor)
                @Html.HiddenFor(model => model.Codigo)
                @Html.HiddenFor(model => model.Incdata)
                @Html.HiddenFor(model => model.Inchora)
                @Html.HiddenFor(model => model.Incusuario)
                @Html.HiddenFor(model => model.Altdata)
                @Html.HiddenFor(model => model.Althora)
                @Html.HiddenFor(model => model.Altusuario)
                @Html.ValidationMessage("CustomError")
                <div class="row" style="padding-top:0px;">
                    <div class="col-md-12">
                        <label class="control-label label-sm">Relógio</label>
                        <div class="form-group input-group-sm">
                            <div class="form-group">
                                <div class="input-group input-group-sm">
                                    @Html.TextBoxFor(model => model.nomeRelogio, new { @class = "form-control input-sm lkpRelogioSelecionado editor-field", id = "lkpRelogioSelecionado" })
                                    <span class="input-group-btn">
                                        <button class="btn btn-primary lkpRelogioSelecionado" id="btnRelogioSelecionado" type="button"><span class="glyphicon glyphicon-search"></span></button>
                                    </span>
                                </div>
                                @Html.ValidationMessageFor(model => model.nomeRelogio)
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="padding-bottom:8px">
                    <div class="col-md-12">
                        <div class="panel panel-default" id="pnlTipoSelecao">
                            <div class="panel-heading" style="padding-top:1px; padding-bottom:0px">
                                <label class="control-label label-sm">Opções</label>
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="radio-inline" data-toggle="radio">
                                            @Html.RadioButtonFor(model => model.tipoHorario, 0, new { id = "idRadioEnvDthServidor", name = "rdio" })
                                            @Html.Label("lbEnvDthServidor", "Enviar Data e Hora do Servidor", new { @class = "control-label label-sm", @for = "idRadioEnvDthServidor" })
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="radio-inline" data-toggle="radio">
                                            @Html.RadioButtonFor(model => model.tipoHorario, 1, new { id = "idRadioEnvDthVerao", name = "rdio" })
                                            @Html.Label("lbEnvDthVerao", "Enviar Horário de Verão", new { @class = "control-label label-sm", @for = "idRadioEnvDthVerao" })
                                        </div>
                                    </div>


                                    @*<div class="col-md-6">
                                            <div class="checkbox" style="margin-top:1px">
                                                @Html.CheckBoxFor(model => model.bEnviaDataHoraServidor, new { id = "bEnviaDataHoraServidor" })
                                                @Html.LabelFor(model => model.bEnviaDataHoraServidor, new { @class = "control-label label-sm", @for = "bEnviaDataHoraServidor" })

                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="checkbox" style="margin-top:1px">
                                                @Html.CheckBoxFor(model => model.bEnviaHorarioVerao, new { id = "bEnviaHorarioVerao" })
                                                @Html.LabelFor(model => model.bEnviaHorarioVerao, new { @class = "control-label label-sm", @for = "bEnviaHorarioVerao" })
                                            </div>
                                        </div>*@
                                </div>
                                @Html.ValidationMessageFor(model => model.tipoHorario)
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default" id="pnlHorariodeVerao" style="margin-top:0; padding-top:0px;">
                            <div class=" panel-heading" style="margin-top:0; margin-bottom:0; padding-top:0; padding-bottom:0px;">Horário de Verão</div>
                            <div class="panel-body" style="margin-top:0; margin-bottom:0; padding-top:0; padding-bottom:10px;">
                                <div class="row">
                                    <div class="col-md-6" style="padding-left:0;">
                                        <div class="form-group">
                                            <div class="form-group input-group-sm">
                                                <div class="col-md-12">
                                                    @Html.LabelFor(model => model.dtInicioHorarioVerao, new { @class = "control-label label-sm" })
                                                    <div class="input-group input-group-sm" onkeypress="dataKeypress('#DataInicialHorarioVerao')">
                                                        @Html.TextBoxFor(model => model.dtInicioHorarioVerao, new { @class = "form-control input-sm MascDate datepickerpt DataHorarioVerao", id = "DataInicialHorarioVerao" })
                                                        <span class="input-group-btn">
                                                            <button class="btn btn-primary btndatepicker DataHorarioVerao" id="btnDataInicialHorarioVerao" type="button" title="Data Inicial"><span class="glyphicon glyphicon-calendar"></span></button>
                                                        </span>
                                                    </div>
                                                    @Html.ValidationMessageFor(model => model.dtInicioHorarioVerao)
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6" style="padding-left:0;">
                                        <div class="form-group">
                                            <div class="form-group input-group-sm">
                                                <div class="col-md-12">
                                                    @Html.LabelFor(model => model.dtFimHorarioVerao, new { @class = "control-label label-sm" })
                                                    <div class="input-group input-group-sm" onkeypress="dataKeypress('#DataFinalHorarioVerao')">
                                                        @Html.TextBoxFor(model => model.dtFimHorarioVerao, new { @class = "form-control input-sm MascDate datepickerpt DataHorarioVerao", id = "DataFinalHorarioVerao" })
                                                        <span class="input-group-btn">
                                                            <button class="btn btn-primary btndatepicker DataHorarioVerao" id="btnDataFinalHorarioVerao" type="button" title="Data Final"><span class="glyphicon glyphicon-calendar"></span></button>
                                                        </span>
                                                    </div>
                                                    @Html.ValidationMessageFor(model => model.dtFimHorarioVerao)
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    @Html.Hidden("intervalo", 0, new { id = "intervalo" })
                                    @Html.ValidationMessage("intervalo")
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel-footer">
                <div class="row">
                    <div class="col-xs-12 center-block">
                        <div style="text-align: right">
                            <button type="submit" id="btnSalvar" class="btn btn-sm btn-success btnPost"><span class="glyphicon glyphicon-ok"></span>&nbsp;Salvar</button>
                            <a id="btnCancelar" class="btn btn-sm btn-danger btnSalvar"
                               href="@Url.Action("Index", "Home")">
                                <span class="glyphicon glyphicon-remove"></span>&nbsp;Cancelar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<script>

    $(document).ready(function () {
        $(":input[type='text']:enabled:visible:first").focus();

        if ($("#idRadioEnvDthVerao").is(':checked')) {
            HabilitaEDesabilitaHorarioVerao(true);
        }
        else {
            HabilitaEDesabilitaHorarioVerao(false);
        }


        cwk_DataCalendario('#btnDataInicialHorarioVerao', '#DataInicialHorarioVerao');
        cwk_DataCalendario('#btnDataFinalHorarioVerao', '#DataFinalHorarioVerao');
        cwk_DataCalendario('#btnDataPEnviar', '#DataPEnviar');

        $('.datepicker').datepicker().on('hide', function (ev) {
            var errorArray = {};
            errorArray["intervalo"] = null;
            $(form).validate().showErrors(errorArray);

            if (($("#DataInicialHorarioVerao").val() != null && $("#DataInicialHorarioVerao").val() != "") && ($("#btnDataFinalHorarioVerao").val() != null &&
                $("#btnDataFinalHorarioVerao").val() != "")) {
                var dias = diasPeriodo($("#DataInicialHorarioVerao").val(), $('#btnDataFinalHorarioVerao').val());
                if (dias <= 0) {
                    errorArray["intervalo"] = 'Data Inícial deve ser menor que a Final';
                    $("form").validate().showErrors(errorArray);
                }
            }
        });
    });

    $(".lkpRelogioSelecionado").bind("keydown click", function (e) {
        cwk_EventoConsultaUnico(e, this, "", "REP", "", "");
        limpaErro($('#lkpRelogioSelecionado').attr('name'));
    });

    $("#idRadioEnvDthServidor").change(function () {
        HabilitaEDesabilitaHorarioVerao(false);
    });


    $("#idRadioEnvDthVerao").change(function () {
        HabilitaEDesabilitaHorarioVerao(true);
    });


    function HabilitaEDesabilitaHorarioVerao(estado) {
        if (estado) {
            $(".DataHorarioVerao").removeAttr('disabled');
        } else {
            $(".DataHorarioVerao").attr('disabled', 'disabled');
            $(".DataHorarioVerao").val('');
        }
    };
    
</script>